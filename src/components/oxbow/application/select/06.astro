---
export const description = "Conditional styling";
import Select from "@/components/fundations/inputs/Select.astro";
import Button from "@/components/fundations/buttons/Button.astro";
const countryOptions = [
  { label: "United States", value: "us" },
  { label: "Canada", value: "ca" },
  { label: "United Kingdom", value: "uk" },
  { label: "Australia", value: "au" },
  { label: "Germany", value: "de" },
  { label: "France", value: "fr" },
  { label: "Japan", value: "jp" },
];
---

<div class="flex justify-center w-full px-12 py-48">
  <div
    class="flex flex-col w-full max-w-sm"
    x-data="{ 
               searchTerm: '',
               allOptions: [
                 { label: 'United States', value: 'us' },
                 { label: 'Canada', value: 'ca' },
                 { label: 'United Kingdom', value: 'uk' },
                 { label: 'Australia', value: 'au' },
                 { label: 'Germany', value: 'de' },
                 { label: 'France', value: 'fr' },
                 { label: 'Japan', value: 'jp' }
               ],
               filteredOptions: [],
               selectedValue: '',
               filterOptions() {
                 if (!this.searchTerm) {
                   this.filteredOptions = [...this.allOptions];
                 } else {
                   const term = this.searchTerm.toLowerCase();
                   this.filteredOptions = this.allOptions.filter(
                     option => option.label.toLowerCase().includes(term)
                   );
                 }
                 console.log('Filtered options:', this.filteredOptions);
               }
             }"
    x-init="filteredOptions = [...allOptions]; console.log('Initial options:', filteredOptions)"
  >
    <div class="mb-4">
      <label for="search" class="block mb-1 font-medium text-base-500 text-sm"
        >Search Countries</label
      >
      <input
        type="text"
        id="search"
        x-model="searchTerm"
        @input="filterOptions()"
        class="block w-full h-10 px-4 py-2 text-sm bg-white border border-transparent text-base-500 ring-1 ring-base-200 placeholder-base-400 focus:border-base-300 focus:bg-transparent focus:outline-none focus:ring-accent-500 focus:ring-offset-2 focus:ring-2 rounded-md"
        placeholder="Type to search..."
      />
    </div>

    <div>
      <label
        for="filtered-select"
        class="block mb-1 font-medium text-base-500 text-sm"
        >Filtered Countries</label
      >
      <select
        id="filtered-select"
        name="filtered-select"
        x-model="selectedValue"
        class="block w-full h-10 px-4 py-2 text-sm bg-white border border-transparent text-base-500 ring-1 ring-base-200 placeholder-base-400 focus:border-base-300 focus:bg-transparent focus:outline-none focus:ring-accent-500 focus:ring-offset-2 focus:ring-2 rounded-md"
      >
        <option value="">Select a country</option>
        <template x-for="option in filteredOptions">
          <option :value="option.value" x-text="option.label"></option>
        </template>
      </select>
    </div>

    <div class="mt-2">
      <p class="text-xs text-base-500 font-medium">
        Selected country: <span
          class="uppercase"
          x-text="selectedValue || 'None'"></span>
      </p>
      <p class="text-xs text-base-500 font-medium" mt-1>
        Showing <span x-text="filteredOptions.length"></span> of <span
          x-text="allOptions.length"></span> countries
      </p>
      <!-- Debug output -->
      <div class="mt-2 text-xs text-base-900 font-medium">
        <p>Search term: <span x-text="searchTerm"></span></p>
        <div
          x-show="filteredOptions.length === 0"
          class="text-red-500 font-medium"
        >
          No matching options found
        </div>
      </div>
    </div>
  </div>
</div>
