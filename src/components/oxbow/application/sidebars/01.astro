---
export const excludeFromObfuscation = [
  // x-transition & responsive utilities used by Alpine
  "opacity-0",
  "opacity-100",
  "translate-x-0",
  "-translate-x-full",
  "sm:translate-x-0",
  "pointer-events-none",
  "pointer-events-auto",
];
import Logo from "@/components/assets/Logo.astro";
import Button from "@/components/fundations/buttons/Button.astro";
import IconButton from "@/components/fundations/buttons/IconButton.astro";
import X from "@/components/fundations/icons/X.astro";
import Home from "@/components/fundations/icons/Home.astro";
import Grid from "@/components/fundations/icons/Grid.astro";
import Report from "@/components/fundations/icons/Report.astro";
import Burger from "@/components/fundations/icons/Burger.astro";
import SearchIcon from "@/components/fundations/icons/Search.astro";
import Settings from "@/components/fundations/icons/Settings.astro";
import Lifebuoy from "@/components/fundations/icons/Lifebuoy.astro";
import FileDots from "@/components/fundations/icons/FileDots.astro";
import Clipboard from "@/components/fundations/icons/Clipboard.astro";
import UsersGroup from "@/components/fundations/icons/UsersGroup.astro";
import CircleInfo from "@/components/fundations/icons/CircleInfo.astro";
import ChevronDown from "@/components/fundations/icons/ChevronDown.astro";
import ExternalLink from "@/components/fundations/icons/ExternalLink.astro";
import ChevronRight from "@/components/fundations/icons/ChevronRight.astro";
---

<div class="relative bg-white dark:bg-zinc-900">
  <!-- copy:start -->
  <!-- Mobile top bar -->
  <div
    class="lg:hidden sticky top-0 z-40 bg-white dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-800"
  >
    <div class="flex items-center justify-between px-4 h-12">
      <div class="flex items-center gap-2">
        <Logo class="text-zinc-900 dark:text-white h-6" />
        <span
          class="text-sm
          font-semibold
          text-zinc-800
          dark:text-zinc-100"
          >Oxbow UI</span
        >
      </div>
      <IconButton
        size="xxs"
        variant="muted"
        x-data
        @click="$dispatch('sidebar-toggle')"
        aria-label="Open navigation"
      >
        <Burger size="sm" />
      </IconButton>
    </div>
  </div>
  <!-- Shell manages sidebar open/close -->
  <div
    x-data="{
      open: false,
      sections: { collections: true, recent: false, team: false },
      search: '',
      active: 'overview',
      recent: [
        { title: 'Getting Started Guide', type: 'guide', time: '2h ago' },
        { title: 'API Documentation', type: 'doc', time: '1d ago' },
        { title: 'User Onboarding Flow', type: 'article', time: '3d ago' },
      ],
      notifications: 5,
    }"
    @sidebar-toggle.window="open = true"
    @keydown.escape.window="open=false"
    class="relative"
  >
    <!-- Overlay for mobile -->
    <div
      class="fixed inset-0 z-40 bg-black/40 dark:bg-white/10 transition-opacity duration-200 lg:hidden"
      x-show="open"
      x-transition.opacity
      @click="open=false"
      aria-hidden="true"
    >
    </div>
    <!-- Sidebar panel -->
    <aside
      class="fixed z-50 inset-y-0 left-0 w-72 lg:w-80 lg:static lg:translate-x-0 transform transition-transform duration-200
             -translate-x-full lg:opacity-100 bg-white dark:bg-zinc-900
             outline outline-1 outline-zinc-200 dark:outline-zinc-800 flex flex-col"
      :class="open ? 'translate-x-0' : ''"
      x-trap.noscroll.inert="open && window.innerWidth < 1024"
    >
      <!-- Header -->
      <div
        class="h-14 shrink-0 flex items-center justify-between px-4 lg:px-5 border-b border-zinc-100 dark:border-zinc-800"
      >
        <div class="flex items-center gap-2">
          <Logo class="text-zinc-900 dark:text-white h-8" />
          <div>
            <p
              class="text-sm font-semibold text-zinc-900 dark:text-zinc-100 leading-tight"
            >
              Oxbow UI
            </p>
            <p class="text-[0.70rem] text-zinc-500 dark:text-zinc-400">
              Knowledge Studio
            </p>
          </div>
        </div>
        <button
          class="lg:hidden p-2 rounded-md outline outline-1 outline-zinc-200 dark:outline-zinc-700 text-zinc-700 dark:text-zinc-200"
          @click="open=false"
          aria-label="Close navigation"
        >
          <X />
        </button>
      </div>
      <!-- Search -->
      <div class="p-3 lg:p-4">
        <label class="relative block">
          <span
            class="absolute inset-y-0 left-0 pl-3 flex items-center text-zinc-500 dark:text-zinc-400"
            ><SearchIcon class="size-4" /></span
          >
          <input
            x-model="search"
            placeholder="Find anythingâ€¦"
            class="w-full h-9 pl-9 pr-3 block w-full h-10 px-4 py-2 text-xs bg-white border border-transparent rounded-lg appearance-none dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 duration-300 ring-1 ring-zinc-200 dark:ring-zinc-700 placeholder-zinc-400 dark:placeholder-zinc-500 focus:border-zinc-300 dark:focus:border-blue-700 focus:bg-transparent focus:outline-none focus:ring-blue-500 focus:ring-offset-2 focus:ring-2 sm:text-sm"
          />
          <!-- Shortcut hint intentionally omitted for demo scope -->
        </label>
      </div>
      <!-- Nav (make this the scrolling region; leave room for sticky footer) -->
      <nav class="flex-1 px-2 lg:px-3 pb-40 overflow-y-auto">
        <ul class="space-y-1">
          <li>
            <button
              class="w-full h-9 px-3 rounded-md flex items-center gap-2 text-sm outline outline-1 outline-transparent
                     hover:bg-zinc-50 dark:hover:bg-white/5"
              :class="active==='overview' ? 'bg-white text-zinc-900 dark:bg-white/10 dark:text-white outline-white/10' : 'text-zinc-700 dark:text-zinc-300'"
              @click="active='overview'"
            >
              <Home class="size-4" />
              <span>Overview</span>
            </button>
          </li>
          <li>
            <button
              class="w-full h-9 px-3 rounded-md flex items-center gap-2 text-sm outline outline-1 outline-transparent
                     hover:bg-zinc-50 dark:hover:bg-white/5"
              :class="active==='workspace' ? 'bg-white text-zinc-900 dark:bg-white/10 dark:text-white outline-white/10' : 'text-zinc-700 dark:text-zinc-300'"
              @click="active='workspace'"
            >
              <Grid class="size-4" />
              <span>Workspace</span>
            </button>
          </li>
          <!-- Collections collapsible -->
          <li class="pt-2 mt-2 border-t border-zinc-100 dark:border-zinc-800">
            <button
              class="w-full h-9 px-3 rounded-md flex items-center justify-between text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
              @click="sections.collections = !sections.collections"
              :aria-expanded="sections.collections"
            >
              <span class="flex items-center gap-2">
                <Clipboard class="size-4" />
                <span>Collections</span>
              </span>
              <span class="text-zinc-500 dark:text-zinc-400">
                <ChevronDown x-show="sections.collections" class="size-4" />
                <ChevronRight x-show="!sections.collections" class="size-4" />
              </span>
            </button>
            <div x-show="sections.collections" x-collapse>
              <ul class="mt-1 pl-2 space-y-1">
                <li>
                  <a
                    href="#_"
                    class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                  >
                    <span class="flex items-center gap-2"
                      ><FileDots class="size-4" /> Drafts</span
                    >
                    <span
                      class="text-[0.70rem] px-1.5 py-0.5 rounded bg-white text-zinc-900 outline outline-1 outline-zinc-200 dark:bg-white/10 dark:text-white dark:outline-white/10"
                      >18</span
                    >
                  </a>
                </li>
                <li>
                  <a
                    href="#_"
                    class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                  >
                    <span class="flex items-center gap-2"
                      ><FileDots class="size-4" /> Published</span
                    >
                    <span
                      class="text-[0.70rem] px-1.5 py-0.5 rounded bg-white text-zinc-900 outline outline-1 outline-zinc-200 dark:bg-white/10 dark:text-white dark:outline-white/10"
                      >64</span
                    >
                  </a>
                </li>
                <li>
                  <a
                    href="#_"
                    class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                  >
                    <span class="flex items-center gap-2"
                      ><FileDots class="size-4" /> Archived</span
                    >
                    <span
                      class="text-[0.70rem] px-1.5 py-0.5 rounded bg-white text-zinc-900 outline outline-1 outline-zinc-200 dark:bg-white/10 dark:text-white dark:outline-white/10"
                      >7</span
                    >
                  </a>
                </li>
              </ul>
            </div>
          </li>
          <li class="pt-2 mt-2 border-t border-zinc-100 dark:border-zinc-800">
            <button
              class="w-full h-9 px-3 rounded-md flex items-center justify-between text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
              @click="sections.recent = !sections.recent"
              :aria-expanded="sections.recent"
            >
              <span class="flex items-center gap-2">
                <FileDots class="size-4" />
                <span>Recent</span>
              </span>
              <span class="text-zinc-500 dark:text-zinc-400">
                <ChevronDown x-show="sections.recent" class="size-4" />
                <ChevronRight x-show="!sections.recent" class="size-4" />
              </span>
            </button>
            <div x-show="sections.recent" x-collapse>
              <ul class="mt-1 pl-2 space-y-1">
                <template x-for="item in recent" :key="item.title">
                  <li>
                    <a
                      href="#_"
                      class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                    >
                      <span class="flex items-center gap-2"
                        ><FileDots class="size-4" />
                        <span x-text="item.title"></span></span
                      >
                      <span
                        class="text-[0.70rem] text-zinc-500 dark:text-zinc-400"
                        x-text="item.time"></span>
                    </a>
                  </li>
                </template>
              </ul>
            </div>
          </li>
          <li>
            <button
              class="w-full h-9 px-3 rounded-md flex items-center justify-between text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
              @click="sections.team = !sections.team"
              :aria-expanded="sections.team"
            >
              <span class="flex items-center gap-2">
                <UsersGroup class="size-4" />
                <span>Team</span>
                <span
                  x-show="notifications > 0"
                  class="text-[0.70rem] px-1.5 py-0.5 rounded bg-rose-500 text-white"
                  x-text="notifications"></span>
              </span>
              <span class="text-zinc-500 dark:text-zinc-400">
                <ChevronDown x-show="sections.team" class="size-4" />
                <ChevronRight x-show="!sections.team" class="size-4" />
              </span>
            </button>
            <div x-show="sections.team" x-collapse>
              <ul class="mt-1 pl-2 space-y-1">
                <li>
                  <a
                    href="#_"
                    class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                  >
                    <span class="flex items-center gap-2"
                      ><UsersGroup class="size-4" /> Members</span
                    >
                    <span
                      class="text-[0.70rem] px-1.5 py-0.5 rounded bg-white text-zinc-900 outline outline-1 outline-zinc-200 dark:bg-white/10 dark:text-white dark:outline-white/10"
                      >12</span
                    >
                  </a>
                </li>
                <li>
                  <a
                    href="#_"
                    class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                  >
                    <span class="flex items-center gap-2"
                      ><Settings class="size-4" /> Roles</span
                    >
                  </a>
                </li>
                <li>
                  <a
                    href="#_"
                    class="group flex items-center justify-between h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                  >
                    <span class="flex items-center gap-2"
                      ><CircleInfo class="size-4" /> Permissions</span
                    >
                  </a>
                </li>
              </ul>
            </div>
          </li>
          <li>
            <a
              href="#_"
              class="flex items-center gap-2 h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
            >
              <Report class="size-4" />
              <span>Insights</span>
            </a>
          </li>
          <li>
            <a
              href="#_"
              class="flex items-center gap-2 h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
            >
              <Grid class="size-4" />
              <span>Integrations</span>
            </a>
          </li>
          <li>
            <a
              href="#_"
              class="flex items-center gap-2 h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
            >
              <Clipboard class="size-4" />
              <span>API</span>
            </a>
          </li>
          <li>
            <a
              href="#_"
              class="flex items-center gap-2 h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
            >
              <Lifebuoy class="size-4" />
              <span>Help Center</span>
              <span
                class="ml-auto text-[0.70rem] px-1.5 py-0.5 rounded bg-white text-zinc-900 outline outline-1 outline-zinc-200 dark:bg-white/10 dark:text-white dark:outline-white/10"
                >Online</span
              >
            </a>
          </li>
          <li class="pt-2 mt-2 border-t border-zinc-100 dark:border-zinc-800">
            <a
              href="#_"
              class="flex items-center gap-2 h-9 px-3 rounded-md text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
            >
              <ExternalLink class="size-4" />
              <span>Open site</span>
              <ExternalLink class="size-3 ml-auto opacity-60" />
            </a>
          </li>
        </ul>
      </nav>
      <!-- Sticky footer (status + account); stays pinned and dropdown overlays upward -->
      <div class="sticky bottom-0 z-10 bg-white dark:bg-zinc-900 border-t border-zinc-100 dark:border-zinc-800">
        <div class="p-3 lg:p-4 space-y-3">
          <div
            class="rounded-xl outline outline-1 outline-zinc-200 dark:outline-zinc-800 bg-white dark:bg-zinc-900 p-3"
          >
            <p class="text-xs font-medium text-zinc-700 dark:text-zinc-200">
              System Status
            </p>
            <p class="mt-1 text-xs text-zinc-500 dark:text-zinc-400">
              All services operational. Last updated 5 min ago.
            </p>
            <div class="mt-2 flex items-center justify-between">
              <button
                class="h-8 px-3 rounded-md bg-white text-zinc-900 text-xs outline outline-1 outline-zinc-200 dark:bg-white/10 dark:text-white dark:outline-white/10"
                >View dashboard</button
              >
              <div class="flex items-center gap-1">
                <div class="size-2 rounded-full bg-emerald-500"></div>
                <span class="text-xs text-zinc-600 dark:text-zinc-300"
                  >Online</span
                >
              </div>
            </div>
          </div>
        </div>
        <!-- Account / footer -->
        <div class="px-3 pb-3 lg:px-4 lg:pb-4">
          <div x-data="{ open:false }" class="relative">
            <button
              class="w-full flex items-center justify-between gap-3 p-2 rounded-lg outline outline-1 outline-zinc-200 dark:outline-zinc-700 hover:bg-zinc-50 dark:hover:bg-white/5"
              @click="open=!open"
            >
              <span class="flex items-center gap-3">
                <img
                  src="https://i.pravatar.cc/40?img=12"
                  alt="Avatar"
                  class="size-8 rounded-full"
                />
                <span class="text-left">
                  <span
                    class="block text-sm font-medium text-zinc-900 dark:text-zinc-100"
                    >Alex W.</span
                  >
                  <span class="block text-xs text-zinc-500 dark:text-zinc-400"
                    >alex@orbitkit.dev</span
                  >
                </span>
              </span>
              <ChevronDown class="size-4 text-zinc-600 dark:text-zinc-300" />
            </button>
            <div
              x-show="open"
              x-transition.opacity
              @click.outside="open=false"
              class="absolute left-0 right-0 bottom-14 z-50 rounded-xl bg-white dark:bg-zinc-900 shadow-xl outline outline-1 outline-zinc-200 dark:outline-zinc-700 overflow-hidden"
            >
              <div class="p-2 text-sm">
                <a
                  href="#_"
                  class="flex items-center justify-between h-9 px-2 rounded-md text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                >
                  <span class="flex items-center gap-2"
                    ><CircleInfo class="size-4" /> View profile</span
                  >
                </a>
                <a
                  href="#_"
                  class="flex items-center justify-between h-9 px-2 rounded-md text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                >
                  <span class="flex items-center gap-2"
                    ><Settings class="size-4" /> Account</span
                  >
                </a>
                <a
                  href="#_"
                  class="flex items-center justify-between h-9 px-2 rounded-md text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5"
                >
                  <span class="flex items-center gap-2"
                    ><Lifebuoy class="size-4" /> Docs</span
                  >
                </a>
              </div>
              <div class="border-t border-zinc-100 dark:border-zinc-800 p-2">
                <Button type="button" variant="muted" class="w-full" size="xxs"
                  >Sign out</Button
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>
  </div>
  <!-- copy:end -->
</div>
