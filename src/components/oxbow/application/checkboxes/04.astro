---
export const description = "Parent Checkbox with Triâ€‘State";
import Text from "@/components/fundations/typography/Text.astro";
---

<section
  class="flex flex-wrap items-center justify-center h-full p-24 bg-white gap-2 dark:bg-zinc-900"
>
  <!-- copy:start -->
  <div
    class="flex flex-col w-full max-w-md gap-2"
    x-data="{
      items: ['Apples','Bananas','Cherries'],
      selected: [],
      toggleAll($refs) {
        if (this.selected.length === this.items.length) {
          this.selected = []
        } else {
          this.selected = [...this.items]
        }
        this.updateParentState($refs)
      },
      updateParentState($refs){
        const all = this.selected.length === this.items.length
        const none = this.selected.length === 0
        $refs.parent.checked = all
        $refs.parent.indeterminate = !all && !none
      }
    }"
    x-init="$watch('selected', () => updateParentState($refs)); updateParentState($refs)"
  >
    <div class="flex items-center gap-3">
      <input
        id="fruits-all"
        name="fruits-all"
        type="checkbox"
        x-ref="parent"
        @change="toggleAll($refs)"
        class="text-blue-600 rounded shadow size-4 border-zinc-300 dark:border-zinc-700 focus:ring-blue-600 dark:bg-zinc-900 dark:checked:bg-blue-600"
      />
      <Text
        for="fruits-all"
        tag="label"
        class="block text-sm text-zinc-600 dark:text-zinc-300"
      >
        Select all fruits
        <span
          class="ml-2 text-xs text-zinc-400 dark:text-zinc-500"
          x-text="`${selected.length}/${items.length} selected`"></span>
      </Text>
    </div>
    <template x-for="item in items" :key="item">
      <div class="flex items-center pl-6 gap-3">
        <input
          type="checkbox"
          :id="`fruit-${item}`"
          :value="item"
          x-model="selected"
          class="text-blue-600 rounded shadow size-4 border-zinc-300 dark:border-zinc-700 focus:ring-blue-600 dark:bg-zinc-900 dark:checked:bg-blue-600"
        />
        <Text
          :for="`fruit-${item}`"
          tag="label"
          class="block text-sm text-zinc-600 dark:text-zinc-300"
          x-text="item"
        />
      </div>
    </template>
  </div>
  <!-- copy:end -->
</section>
