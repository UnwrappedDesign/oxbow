---
export const excludeFromObfuscation = [
  "text-zinc-600",
  "bg-zinc-600",
  "ring-1",
  "ring-zinc-200",
];

import HomeIcon from "@/components/fundations/icons/Home.astro";
import GridIcon from "@/components/fundations/icons/Grid.astro";
import ComponentIcon from "@/components/fundations/icons/Component.astro";
import UsersIcon from "@/components/fundations/icons/UsersGroup.astro";
---

<div
  class="flex flex-col justify-center p-12 mx-auto bg-white dark:bg-zinc-900"
>
  <!-- Accessible Tabs • Compact icon-only -->
  <div
    x-data="{
      keys: ['overview','projects','packages','team'],
      selected: 'overview',
      focus: 0,
      init(){ this.focus = 0 },
      select(id){ this.selected=id; this.focus=this.keys.indexOf(id) },
      onKeydown(e){
        const last=this.keys.length-1; let i=this.focus;
        if(e.key==='ArrowRight'||e.key==='ArrowDown') i=i===last?0:i+1;
        else if(e.key==='ArrowLeft'||e.key==='ArrowUp') i=i===0?last:i-1;
        else if(e.key==='Home') i=0; else if(e.key==='End') i=last; else return;
        e.preventDefault(); const id=this.keys[i]; this.focus=i; this.$nextTick(()=>this.$refs['tab-'+id]?.focus());
      }
    }"
    class="w-full max-w-xl mx-auto"
  >
    <div
      role="tablist"
      aria-orientation="horizontal"
      class="flex justify-center gap-3"
    >
      <template x-for="(id, idx) in keys" :key="id">
        <button
          class="relative w-10 h-10 inline-flex items-center justify-center rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-zinc-500/50"
          :id="'tab-'+id"
          role="tab"
          :aria-selected="selected===id"
          :tabindex="focus===idx?0:-1"
          :aria-controls="'panel-'+id"
          x-ref="tab-[[id]]"
          :title="id.charAt(0).toUpperCase()+id.slice(1)"
          aria-label="Tab"
          @click="select(id)"
          @keydown="onKeydown($event)"
          :class="selected===id ? 'text-zinc-600 dark:text-zinc-400 bg-white dark:bg-zinc-900 ring-1 ring-zinc-200 dark:ring-zinc-700' : 'text-zinc-600 dark:text-zinc-200 bg-zinc-50 dark:bg-zinc-800 hover:text-zinc-900 dark:hover:text-zinc-100'"
        >
          <template x-if="id==='overview'"
            ><span><HomeIcon size="sm" class="text-current" /></span></template
          >
          <template x-if="id==='projects'"
            ><span><GridIcon size="sm" class="text-current" /></span></template
          >
          <template x-if="id==='packages'"
            ><span><ComponentIcon size="sm" class="text-current" /></span
            ></template
          >
          <template x-if="id==='team'"
            ><span><UsersIcon size="sm" class="text-current" /></span></template
          >
          <span
            class="absolute left-1/2 -bottom-1 h-1 w-1.5 -translate-x-1/2 rounded-full"
            :class="selected===id ? 'bg-zinc-600 dark:bg-zinc-400' : 'bg-transparent'"
            aria-hidden="true"></span>
        </button>
      </template>
    </div>

    <div class="pt-4 text-sm text-zinc-500 dark:text-zinc-300">
      <template x-for="id in keys" :key="'panel-'+id">
        <section
          x-show="selected===id"
          x-cloak
          role="tabpanel"
          :id="'panel-'+id"
          :aria-labelledby="'tab-'+id"
          class="text-center"
        >
          <p>
            <span x-text="id.charAt(0).toUpperCase()+id.slice(1)"></span> content
            — compact icon-only tabs.
          </p>
        </section>
      </template>
    </div>
  </div>
</div>
