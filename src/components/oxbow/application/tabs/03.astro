---
export const excludeFromObfuscation = [
  "bg-white",
  "text-zinc-600",
  "ring-1",
  "ring-zinc-200",
  "bg-zinc-50",
];

import HomeIcon from "@/components/fundations/icons/Home.astro";
import GridIcon from "@/components/fundations/icons/Grid.astro";
import ComponentIcon from "@/components/fundations/icons/Component.astro";
---

<div
  class="flex flex-col justify-center p-12 mx-auto items-center bg-white dark:bg-zinc-900"
>
  <!-- Accessible Tabs • With icons and counts -->
  <div
    x-data="{
      keys: ['overview','projects','packages','team'],
      selected: 'overview',
      focus: 0,
      init(){ this.focus = 0; },
      select(id){ this.selected = id; this.focus = this.keys.indexOf(id); },
      onKeydown(e){
        const last = this.keys.length - 1;
        let i = this.focus;
        if (e.key==='ArrowRight' || e.key==='ArrowDown'){ i = i === last ? 0 : i+1; }
        else if (e.key==='ArrowLeft' || e.key==='ArrowUp'){ i = i === 0 ? last : i-1; }
        else if (e.key==='Home'){ i = 0; }
        else if (e.key==='End'){ i = last; }
        else { return; }
        e.preventDefault();
        const id = this.keys[i];
        this.focus = i;
        this.$nextTick(() => this.$refs['tab-'+id]?.focus());
      }
    }"
    class="mx-auto max-w-3xl"
  >
    <div
      role="tablist"
      aria-orientation="horizontal"
      class="flex flex-wrap gap-2 justify-center"
    >
      <template x-for="(id, idx) in keys" :key="id">
        <button
          class="inline-flex items-center gap-2 px-3 h-9 text-sm font-medium rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-zinc-500/50 transition"
          :id="'tab-'+id"
          role="tab"
          :aria-selected="selected===id"
          :tabindex="focus===idx ? 0 : -1"
          :aria-controls="'panel-'+id"
          x-ref="tab-[[id]]"
          @click="select(id)"
          @keydown="onKeydown($event)"
          :class="selected===id ? 'bg-white dark:bg-zinc-900 text-zinc-600 shadow-sm ring-1 ring-zinc-200 dark:ring-zinc-700' : 'bg-zinc-50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-200 hover:text-zinc-900 dark:hover:text-zinc-100'"
        >
          <span class="inline-flex items-center gap-2">
            <span class="inline-flex items-center justify-center">
              <template x-if="id==='overview'"
                ><span><HomeIcon size="sm" class="text-current" /></span
                ></template
              >
              <template x-if="id==='projects'"
                ><span><GridIcon size="sm" class="text-current" /></span
                ></template
              >
              <template x-if="id==='packages'"
                ><span><ComponentIcon size="sm" class="text-current" /></span
                ></template
              >
              <template x-if="id==='team'"
                ><span><ComponentIcon size="sm" class="text-current" /></span
                ></template
              >
            </span>
            <span x-text="id.charAt(0).toUpperCase()+id.slice(1)"></span>
            <template x-if="id!=='overview'">
              <span
                class="ml-1 inline-flex items-center px-1.5 h-5 text-[11px] rounded-full bg-zinc-50 dark:bg-zinc-800 text-zinc-500 dark:text-zinc-300 border border-zinc-200 dark:border-zinc-700"
                x-text="id==='projects'? '3' : id==='packages' ? '7' : '2'"
              ></span>
            </template>
          </span>
        </button>
      </template>
    </div>
    <div class="pt-4 text-sm text-zinc-500 dark:text-zinc-300 w-full">
      <section
        x-show="selected==='overview'"
        x-cloak
        role="tabpanel"
        :id="'panel-overview'"
        aria-labelledby="tab-overview"
      >
        <p>Overview content — activity feed and quick insights.</p>
      </section>
      <section
        x-show="selected==='projects'"
        x-cloak
        role="tabpanel"
        :id="'panel-projects'"
        aria-labelledby="tab-projects"
      >
        <p>Projects content — boards, backlogs, and sprints.</p>
      </section>
      <section
        x-show="selected==='packages'"
        x-cloak
        role="tabpanel"
        :id="'panel-packages'"
        aria-labelledby="tab-packages"
      >
        <p>Packages content — registries, dist tags, and visibility.</p>
      </section>
      <section
        x-show="selected==='team'"
        x-cloak
        role="tabpanel"
        :id="'panel-team'"
        aria-labelledby="tab-team"
      >
        <p>Team content — members, roles, and invitations.</p>
      </section>
    </div>
  </div>
</div>
